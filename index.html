<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Num√©rologie">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="description" content="Application de Num√©rologie de Pythagore - Calculez votre chemin de vie, nombre d'expression et cycles de vie">
    <meta name="keywords" content="num√©rologie, pythagore, chemin de vie, cycles, expression">
    <meta name="author" content="Num√©rologie de Pythagore">
    <title>Num√©rologie de Pythagore v1.9.7</title>
    <!-- Updated: 2025-12-09 17:30 - Fix: All Round Buttons Always Visible on Mobile -->
    
    <!-- External CSS -->
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>Num√©rologie de Pythagore <span class="version" id="app-version">v1.9.7</span> <span class="build-info" id="build-info">Build: 2025-12-09 17:30</span></h1>
        </header>

        <div class="main-content">
            <!-- Left Panel - Data Input -->
            <div class="left-panel">
                <h2>üìù Donn√©es personnelles</h2>
                
                <form id="client-form">
                    <div class="form-group">
                        <label for="firstName1">Pr√©nom 1 <span class="required">*</span></label>
                        <input type="text" id="firstName1" name="firstName1" required placeholder="Entrez le premier pr√©nom (obligatoire)">
                        <div class="error-message" id="firstName1-error"></div>
                    </div>
                    
                    <div class="form-group">
                        <label for="firstName2">Pr√©nom 2</label>
                        <input type="text" id="firstName2" name="firstName2" placeholder="Entrez le deuxi√®me pr√©nom (optionnel)">
                        <div class="error-message" id="firstName2-error"></div>
                    </div>
                    
                    <div class="form-group">
                        <label for="firstName3">Pr√©nom 3</label>
                        <input type="text" id="firstName3" name="firstName3" placeholder="Entrez le troisi√®me pr√©nom (optionnel)">
                        <div class="error-message" id="firstName3-error"></div>
                    </div>
                    
                    <div class="form-group">
                        <label for="lastName">Nom de famille <span class="required">*</span></label>
                        <input type="text" id="lastName" name="lastName" required placeholder="Entrez le nom de famille (obligatoire)">
                        <div class="error-message" id="lastName-error"></div>
                    </div>
                    
                    <div class="form-group">
                        <label for="birthDate">Date de naissance <span class="required">*</span></label>
                        <input type="date" id="birthDate" name="birthDate" required>
                        <div class="error-message" id="birthDate-error"></div>
                    </div>
                    
                    <div class="form-actions">
                        <button type="submit" id="submit-btn" class="btn btn-primary" disabled>
                            <span class="gear-large">‚öôÔ∏è</span><span class="gear-medium">‚öôÔ∏è</span> Calculer les r√©sultats
                        </button>
                        <button type="button" id="reset-btn" class="btn btn-secondary">
                            üîÑ R√©initialiser
                        </button>
                    </div>
                </form>
                
                <!-- ALTERNATIVE: iPhone Safari Floating Action Buttons -->
                <div class="mobile-fab-container" id="mobile-fab-container">
                    <div class="fab-backdrop"></div>
                    <button type="button" id="mobile-submit-btn" class="fab fab-primary" disabled>
                        <span class="fab-icon">‚öôÔ∏è</span>
                        <span class="fab-text">Calculer</span>
                    </button>
                    <button type="button" id="mobile-reset-btn" class="fab fab-secondary">
                        <span class="fab-icon">üîÑ</span>
                        <span class="fab-text">Reset</span>
                    </button>
                </div>
            </div>

            <!-- Right Panel - Tabbed Interface -->
            <div class="right-panel">
                <div class="client-info-header" id="client-info-header" style="display: none;"></div>
                
                <div class="tab-navigation">
                    <button class="tab-btn active" id="tab1-btn" onclick="switchTab('tab1')">Piliers</button>
                    <button class="tab-btn" id="tab2-btn" onclick="switchTab('tab2')">Cycles</button>
                    <button class="tab-btn" id="tab3-btn" onclick="switchTab('tab3')">Phase de r√©alisation</button>
                </div>
                
                <div class="tab-content">
                    <div class="tab-panel active" id="tab1-panel">
                        <div class="results-area" id="results-area">
                            <div class="empty-state" id="empty-state">
                                Remplissez les champs obligatoires (Pr√©nom 1, Nom de famille, Date de naissance) et cliquez sur "Calculer les r√©sultats" pour voir les sorties ici.
                            </div>
                            <div class="results-grid" id="results-container" style="display: none;"></div>
                        </div>
                    </div>
                    
                    <div class="tab-panel" id="tab2-panel">
                        <div class="results-area" id="cycles-area">
                            <div class="empty-state" id="cycles-empty-state">
                                Remplissez les champs obligatoires et cliquez sur "Calculer les r√©sultats" pour voir les cycles de vie ici.
                            </div>
                            <div class="cycles-grid" id="cycles-container" style="display: none;"></div>
                        </div>
                    </div>
                    
                    <div class="tab-panel" id="tab3-panel">
                        <div class="results-area" id="realization-area">
                            <div class="empty-state" id="realization-empty-state">
                                Remplissez les champs obligatoires et cliquez sur "Calculer les r√©sultats" pour voir la phase de r√©alisation ici.
                            </div>
                            <div class="realization-grid" id="realization-container" style="display: none;"></div>
                        </div>
                    </div>
                </div>
                
                <div class="panel-actions" id="panel-actions" style="display: none;">
                    <button type="button" id="generate-pdf-btn" class="action-btn pdf-btn">üìÑ G√©n√©rer rapport PDF</button>
                    <button type="button" id="print-results-btn" class="action-btn print-btn">üñ®Ô∏è Imprimer les r√©sultats</button>
                </div>
                
                <!-- Mobile Reset Button for Frame 2 (Results) -->
                <div class="mobile-frame2-reset-container" id="mobile-frame2-reset-container" style="display: none;">
                    <button type="button" id="mobile-frame2-reset-btn" class="mobile-frame2-reset-btn" onclick="if(window.mobileFrameSwitcher){window.mobileFrameSwitcher.showFrame1();} console.log('Button clicked!');">
                        <span class="reset-icon">üîÑ</span>
                        <span class="reset-text">Nouveau<br>Calcul</span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- External JavaScript Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    
    <!-- NUCLEAR OPTION: Create buttons from scratch with JavaScript -->
    <script>
        // NUCLEAR: Create completely new buttons that bypass all CSS issues
        function createNuclearButtons() {
            const isMobile = window.innerWidth <= 480 || /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);
            
            if (isMobile) {
                console.log('üö® NUCLEAR: Creating buttons from scratch for iPhone');
                
                // Remove any existing mobile buttons
                const existingNuclear = document.getElementById('nuclear-buttons');
                if (existingNuclear) {
                    existingNuclear.remove();
                }
                
                // Hide original form actions completely
                const formActions = document.querySelector('.form-actions');
                if (formActions) {
                    formActions.style.display = 'none !important';
                }
                
                // Create nuclear button container
                const nuclearContainer = document.createElement('div');
                nuclearContainer.id = 'nuclear-buttons';
                nuclearContainer.style.cssText = `
                    position: fixed !important;
                    bottom: 0px !important;
                    left: 0px !important;
                    right: 0px !important;
                    width: 100vw !important;
                    height: 120px !important;
                    z-index: 2147483647 !important;
                    pointer-events: none !important;
                    background: linear-gradient(180deg, rgba(0,0,0,0) 0%, rgba(0,0,0,0.9) 100%) !important;
                `;
                
                // Create CALCULATE button
                const calculateBtn = document.createElement('button');
                calculateBtn.id = 'nuclear-calculate';
                calculateBtn.innerHTML = '‚öôÔ∏è<br>CALCULER';
                calculateBtn.disabled = true;
                calculateBtn.style.cssText = `
                    position: absolute !important;
                    bottom: 20px !important;
                    right: 20px !important;
                    width: 72px !important;
                    height: 72px !important;
                    border-radius: 50% !important;
                    border: 4px solid #ffffff !important;
                    background: #27ae60 !important;
                    color: #ffffff !important;
                    font-size: 12px !important;
                    font-weight: 900 !important;
                    text-align: center !important;
                    line-height: 1.2 !important;
                    box-shadow: 0 12px 40px rgba(0,0,0,0.9) !important;
                    cursor: pointer !important;
                    pointer-events: auto !important;
                    -webkit-tap-highlight-color: transparent !important;
                    -webkit-appearance: none !important;
                    appearance: none !important;
                    transform: translateZ(0) !important;
                    -webkit-transform: translateZ(0) !important;
                    will-change: transform !important;
                `;
                
                // Create RESET button
                const resetBtn = document.createElement('button');
                resetBtn.id = 'nuclear-reset';
                resetBtn.innerHTML = 'üîÑ<br>RESET';
                resetBtn.style.cssText = `
                    position: absolute !important;
                    bottom: 20px !important;
                    right: 104px !important;
                    width: 72px !important;
                    height: 72px !important;
                    border-radius: 50% !important;
                    border: 4px solid #ffffff !important;
                    background: #e74c3c !important;
                    color: #ffffff !important;
                    font-size: 12px !important;
                    font-weight: 900 !important;
                    text-align: center !important;
                    line-height: 1.2 !important;
                    box-shadow: 0 12px 40px rgba(0,0,0,0.9) !important;
                    cursor: pointer !important;
                    pointer-events: auto !important;
                    -webkit-tap-highlight-color: transparent !important;
                    -webkit-appearance: none !important;
                    appearance: none !important;
                    transform: translateZ(0) !important;
                    -webkit-transform: translateZ(0) !important;
                    will-change: transform !important;
                `;
                
                // Add touch feedback
                [calculateBtn, resetBtn].forEach(btn => {
                    btn.addEventListener('touchstart', function() {
                        this.style.transform = 'translateZ(0) scale(0.95) !important';
                        this.style.webkitTransform = 'translateZ(0) scale(0.95) !important';
                    });
                    
                    btn.addEventListener('touchend', function() {
                        this.style.transform = 'translateZ(0) scale(1) !important';
                        this.style.webkitTransform = 'translateZ(0) scale(1) !important';
                    });
                });
                
                // Add buttons to container
                nuclearContainer.appendChild(calculateBtn);
                nuclearContainer.appendChild(resetBtn);
                
                // Add container to body
                document.body.appendChild(nuclearContainer);
                
                // Connect to form functionality
                const form = document.getElementById('client-form');
                
                // Calculate button functionality
                calculateBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    console.log('üö® NUCLEAR: Calculate button clicked');
                    if (form && !this.disabled) {
                        const submitEvent = new Event('submit', { bubbles: true, cancelable: true });
                        form.dispatchEvent(submitEvent);
                    }
                });
                
                // Reset button functionality
                resetBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    console.log('üö® NUCLEAR: Reset button clicked');
                    if (form) {
                        form.reset();
                        // Trigger reset event
                        const resetEvent = new Event('reset', { bubbles: true });
                        form.dispatchEvent(resetEvent);
                        
                        // Clear any error states
                        document.querySelectorAll('.form-group').forEach(group => {
                            group.classList.remove('error');
                        });
                        document.querySelectorAll('.error-message').forEach(error => {
                            error.classList.remove('show');
                        });
                        
                        // Disable calculate button
                        calculateBtn.disabled = true;
                        calculateBtn.style.background = '#95a5a6 !important';
                        calculateBtn.style.opacity = '0.7 !important';
                    }
                });
                
                // Form validation to enable/disable calculate button
                function updateCalculateButton() {
                    const firstName1 = document.getElementById('firstName1').value.trim();
                    const lastName = document.getElementById('lastName').value.trim();
                    const birthDate = document.getElementById('birthDate').value;
                    
                    const isValid = firstName1 && lastName && birthDate;
                    
                    calculateBtn.disabled = !isValid;
                    if (isValid) {
                        calculateBtn.style.background = '#27ae60 !important';
                        calculateBtn.style.opacity = '1 !important';
                    } else {
                        calculateBtn.style.background = '#95a5a6 !important';
                        calculateBtn.style.opacity = '0.7 !important';
                    }
                }
                
                // Listen for form changes
                const inputs = form.querySelectorAll('input');
                inputs.forEach(input => {
                    input.addEventListener('input', updateCalculateButton);
                    input.addEventListener('change', updateCalculateButton);
                });
                
                // Initial validation
                updateCalculateButton();
                
                console.log('‚úÖ NUCLEAR: Buttons created and functional');
            }
        }
        
        // Run nuclear option immediately
        createNuclearButtons();
        document.addEventListener('DOMContentLoaded', createNuclearButtons);
        window.addEventListener('load', createNuclearButtons);
        window.addEventListener('resize', createNuclearButtons);
        
        // ULTRA NUCLEAR MOBILE LAYOUT FIX
        function createUltraMobileLayout() {
            const isMobile = window.innerWidth <= 480 || /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);
            
            if (isMobile) {
                console.log('üö® ULTRA NUCLEAR: Creating mobile-first layout for iPhone');
                
                // STEP 1: Force single-column layout on mobile
                const mainContent = document.querySelector('.main-content');
                if (mainContent) {
                    mainContent.style.cssText = `
                        display: flex !important;
                        flex-direction: column !important;
                        height: calc(100vh - 140px) !important;
                        overflow: hidden !important;
                        gap: 0 !important;
                    `;
                }
                
                // STEP 2: Make left panel (form) ULTRA COMPACT
                const leftPanel = document.querySelector('.left-panel');
                if (leftPanel) {
                    leftPanel.style.cssText = `
                        flex: 0 0 auto !important;
                        max-height: 25vh !important;
                        overflow-y: auto !important;
                        -webkit-overflow-scrolling: touch !important;
                        padding: 8px !important;
                        background: white !important;
                        border-bottom: 3px solid #3498db !important;
                        margin-bottom: 5px !important;
                        border-radius: 8px 8px 0 0 !important;
                    `;
                }
                
                // STEP 2.1: Compact form header
                const formHeader = leftPanel.querySelector('h2');
                if (formHeader) {
                    formHeader.style.cssText = `
                        font-size: 16px !important;
                        margin-bottom: 8px !important;
                        margin-top: 0 !important;
                        padding-bottom: 4px !important;
                        border-bottom: 1px solid #ecf0f1 !important;
                        color: #2c3e50 !important;
                    `;
                }
                
                // STEP 2.2: Ultra compact form groups
                const formGroups = leftPanel.querySelectorAll('.form-group');
                formGroups.forEach(group => {
                    group.style.cssText = `
                        margin-bottom: 8px !important;
                        padding: 0 !important;
                    `;
                });
                
                // STEP 2.3: Compact labels
                const labels = leftPanel.querySelectorAll('label');
                labels.forEach(label => {
                    label.style.cssText = `
                        display: block !important;
                        margin-bottom: 3px !important;
                        font-weight: 600 !important;
                        color: #2c3e50 !important;
                        font-size: 14px !important;
                        line-height: 1.2 !important;
                    `;
                });
                
                // STEP 2.4: Compact input fields
                const inputs = leftPanel.querySelectorAll('input');
                inputs.forEach(input => {
                    input.style.cssText = `
                        width: 100% !important;
                        padding: 8px 10px !important;
                        border: 1px solid #bdc3c7 !important;
                        border-radius: 6px !important;
                        font-size: 16px !important;
                        height: 40px !important;
                        transition: border-color 0.3s ease !important;
                        -webkit-appearance: none !important;
                        appearance: none !important;
                        background: white !important;
                    `;
                });
                
                // STEP 2.5: Keep all fields visible but compact
                // All form fields remain visible with compact styling
                
                // STEP 3: Make right panel (results) take most of the space
                const rightPanel = document.querySelector('.right-panel');
                if (rightPanel) {
                    rightPanel.style.cssText = `
                        flex: 1 !important;
                        display: flex !important;
                        flex-direction: column !important;
                        overflow: hidden !important;
                        background: white !important;
                        padding: 10px !important;
                        min-height: 50vh !important;
                    `;
                }
                
                // STEP 4: Force tab navigation to be prominent
                const tabNavigation = document.querySelector('.tab-navigation');
                if (tabNavigation) {
                    tabNavigation.style.cssText = `
                        display: flex !important;
                        flex-shrink: 0 !important;
                        margin-bottom: 15px !important;
                        border-bottom: 3px solid #ecf0f1 !important;
                        background: white !important;
                        padding: 5px 0 !important;
                    `;
                }
                
                // STEP 5: Make tab buttons larger and more touch-friendly
                const tabButtons = document.querySelectorAll('.tab-btn');
                tabButtons.forEach(btn => {
                    btn.style.cssText = `
                        flex: 1 !important;
                        padding: 15px 8px !important;
                        border: none !important;
                        background: #f8f9fa !important;
                        color: #7f8c8d !important;
                        cursor: pointer !important;
                        border-radius: 8px !important;
                        margin: 0 3px !important;
                        font-weight: 700 !important;
                        font-size: 14px !important;
                        min-height: 50px !important;
                        text-align: center !important;
                        -webkit-tap-highlight-color: transparent !important;
                        box-shadow: 0 2px 4px rgba(0,0,0,0.1) !important;
                    `;
                    
                    if (btn.classList.contains('active')) {
                        btn.style.background = '#3498db !important';
                        btn.style.color = 'white !important';
                        btn.style.boxShadow = '0 4px 8px rgba(52, 152, 219, 0.3) !important';
                    }
                });
                
                // STEP 6: Make tab content area much larger
                const tabContent = document.querySelector('.tab-content');
                if (tabContent) {
                    tabContent.style.cssText = `
                        flex: 1 !important;
                        overflow: hidden !important;
                        min-height: 0 !important;
                        background: white !important;
                        position: relative !important;
                        border: 2px solid #ecf0f1 !important;
                        border-radius: 8px !important;
                    `;
                }
                
                // STEP 7: Force tab panels to use full available space
                const tabPanels = document.querySelectorAll('.tab-panel');
                tabPanels.forEach((panel, index) => {
                    panel.style.cssText = `
                        position: absolute !important;
                        top: 0 !important;
                        left: 0 !important;
                        right: 0 !important;
                        bottom: 0 !important;
                        overflow-y: auto !important;
                        -webkit-overflow-scrolling: touch !important;
                        padding: 20px !important;
                        background: white !important;
                        display: ${panel.classList.contains('active') ? 'block' : 'none'} !important;
                    `;
                });
                
                // STEP 8: Make results areas fully scrollable
                const resultsAreas = document.querySelectorAll('.results-area, .cycles-area, .realization-area');
                resultsAreas.forEach(area => {
                    area.style.cssText = `
                        height: 100% !important;
                        overflow-y: auto !important;
                        -webkit-overflow-scrolling: touch !important;
                        padding: 0 !important;
                        background: transparent !important;
                    `;
                });
                
                // STEP 9: Make empty states more prominent
                const emptyStates = document.querySelectorAll('.empty-state');
                emptyStates.forEach(state => {
                    state.style.cssText = `
                        text-align: center !important;
                        color: #7f8c8d !important;
                        font-style: italic !important;
                        padding: 40px 20px !important;
                        font-size: 18px !important;
                        line-height: 1.5 !important;
                        background: #f8f9fa !important;
                        border-radius: 12px !important;
                        margin: 20px 0 !important;
                        display: block !important;
                        border: 2px dashed #bdc3c7 !important;
                    `;
                });
                
                // STEP 10: Optimize result containers for mobile
                const resultContainers = document.querySelectorAll('.results-grid, .cycles-grid, .realization-grid');
                resultContainers.forEach(container => {
                    container.style.cssText = `
                        display: block !important;
                        padding: 0 !important;
                        background: transparent !important;
                        min-height: auto !important;
                        height: auto !important;
                        overflow: visible !important;
                    `;
                });
                
                // STEP 11: Make result items larger and more readable
                const resultItems = document.querySelectorAll('.result-item, .cycle-item, .realization-item');
                resultItems.forEach(item => {
                    item.style.cssText = `
                        background: #f8f9fa !important;
                        border: 2px solid #e9ecef !important;
                        border-radius: 12px !important;
                        padding: 20px !important;
                        text-align: center !important;
                        display: block !important;
                        min-height: 100px !important;
                        margin-bottom: 15px !important;
                        font-size: 16px !important;
                        line-height: 1.4 !important;
                        box-shadow: 0 2px 8px rgba(0,0,0,0.1) !important;
                    `;
                });
                
                // STEP 12: Hide form panel actions on mobile (they interfere)
                const panelActions = document.querySelector('.panel-actions');
                if (panelActions) {
                    panelActions.style.display = 'none !important';
                }
                
                console.log('‚úÖ ULTRA NUCLEAR: Mobile layout created with large content area');
            }
        }
        
        // Run ultra mobile layout fix
        createUltraMobileLayout();
        document.addEventListener('DOMContentLoaded', createUltraMobileLayout);
        window.addEventListener('load', createUltraMobileLayout);
        window.addEventListener('resize', createUltraMobileLayout);
        
        // FINAL NUCLEAR: Complete Mobile Interface Replacement
        function createMobileOnlyInterface() {
            const isMobile = window.innerWidth <= 480 || /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);
            
            if (isMobile) {
                console.log('üö® FINAL NUCLEAR: Creating complete mobile-only interface');
                
                // STEP 1: Hide the entire right panel
                const rightPanel = document.querySelector('.right-panel');
                if (rightPanel) {
                    rightPanel.style.display = 'none !important';
                }
                
                // STEP 2: Create a brand new mobile results container
                let mobileResults = document.getElementById('mobile-results-interface');
                if (mobileResults) {
                    mobileResults.remove();
                }
                
                mobileResults = document.createElement('div');
                mobileResults.id = 'mobile-results-interface';
                mobileResults.style.cssText = `
                    position: fixed !important;
                    top: 50vh !important;
                    left: 0 !important;
                    right: 0 !important;
                    bottom: 120px !important;
                    background: white !important;
                    border: 3px solid #3498db !important;
                    border-radius: 12px 12px 0 0 !important;
                    z-index: 1000000 !important;
                    overflow-y: auto !important;
                    -webkit-overflow-scrolling: touch !important;
                    padding: 20px !important;
                    box-shadow: 0 -10px 30px rgba(0,0,0,0.3) !important;
                `;
                
                // STEP 3: Create mobile tab navigation
                const mobileTabNav = document.createElement('div');
                mobileTabNav.style.cssText = `
                    display: flex !important;
                    margin-bottom: 20px !important;
                    border-bottom: 2px solid #ecf0f1 !important;
                    padding-bottom: 10px !important;
                `;
                
                const tabs = [
                    { id: 'mobile-tab1', label: 'Piliers', active: true },
                    { id: 'mobile-tab2', label: 'Cycles', active: false },
                    { id: 'mobile-tab3', label: 'R√©alisation', active: false }
                ];
                
                tabs.forEach(tab => {
                    const tabBtn = document.createElement('button');
                    tabBtn.id = tab.id;
                    tabBtn.textContent = tab.label;
                    tabBtn.style.cssText = `
                        flex: 1 !important;
                        padding: 15px 10px !important;
                        border: none !important;
                        background: ${tab.active ? '#3498db' : '#f8f9fa'} !important;
                        color: ${tab.active ? 'white' : '#7f8c8d'} !important;
                        font-size: 16px !important;
                        font-weight: 700 !important;
                        border-radius: 8px !important;
                        margin: 0 3px !important;
                        cursor: pointer !important;
                        -webkit-tap-highlight-color: transparent !important;
                    `;
                    
                    tabBtn.addEventListener('click', function() {
                        // Update tab states
                        mobileTabNav.querySelectorAll('button').forEach(btn => {
                            btn.style.background = '#f8f9fa !important';
                            btn.style.color = '#7f8c8d !important';
                        });
                        this.style.background = '#3498db !important';
                        this.style.color = 'white !important';
                        
                        // Show corresponding content
                        showMobileTabContent(tab.id);
                    });
                    
                    mobileTabNav.appendChild(tabBtn);
                });
                
                // STEP 4: Create mobile content area
                const mobileContent = document.createElement('div');
                mobileContent.id = 'mobile-content-area';
                mobileContent.style.cssText = `
                    min-height: 300px !important;
                    background: white !important;
                    padding: 10px !important;
                `;
                
                // STEP 5: Add initial empty state
                mobileContent.innerHTML = `
                    <div id="mobile-empty-state" style="
                        text-align: center !important;
                        color: #7f8c8d !important;
                        font-size: 18px !important;
                        padding: 40px 20px !important;
                        background: #f8f9fa !important;
                        border-radius: 12px !important;
                        border: 2px dashed #bdc3c7 !important;
                        line-height: 1.5 !important;
                    ">
                        Remplissez le formulaire et appuyez sur CALCULER pour voir vos r√©sultats ici.
                    </div>
                `;
                
                // STEP 6: Assemble mobile interface
                mobileResults.appendChild(mobileTabNav);
                mobileResults.appendChild(mobileContent);
                document.body.appendChild(mobileResults);
                
                console.log('‚úÖ FINAL NUCLEAR: Mobile-only interface created');
                
                // STEP 7: Create mobile results display function
                window.displayMobileResults = function(results) {
                    console.log('üì± Displaying results in mobile interface:', results);
                    
                    const contentArea = document.getElementById('mobile-content-area');
                    if (!contentArea) return;
                    
                    // Hide empty state
                    const emptyState = document.getElementById('mobile-empty-state');
                    if (emptyState) {
                        emptyState.style.display = 'none';
                    }
                    
                    // Create results HTML
                    contentArea.innerHTML = `
                        <div id="mobile-tab1-content" style="display: block;">
                            <h3 style="color: #2c3e50; margin-bottom: 20px; text-align: center; font-size: 20px;">üìä Piliers de Num√©rologie</h3>
                            
                            <div style="background: #e8f5e8; border: 2px solid #27ae60; border-radius: 12px; padding: 20px; margin-bottom: 20px; text-align: center;">
                                <h4 style="color: #2c3e50; margin-bottom: 10px;">Chemin de vie</h4>
                                <div style="font-size: 36px; font-weight: bold; color: #27ae60;">${results.output1 || 'N/A'}</div>
                            </div>
                            
                            <div style="background: #e8f4fd; border: 2px solid #3498db; border-radius: 12px; padding: 20px; margin-bottom: 20px; text-align: center;">
                                <h4 style="color: #2c3e50; margin-bottom: 10px;">Nombre d'expression</h4>
                                <div style="font-size: 36px; font-weight: bold; color: #3498db;">${results.output3 || 'N/A'}</div>
                            </div>
                            
                            <div style="background: #fff3cd; border: 2px solid #ffc107; border-radius: 12px; padding: 20px;">
                                <h4 style="color: #2c3e50; margin-bottom: 15px; text-align: center;">Grille d'inclusion</h4>
                                <div id="mobile-inclusion-grid"></div>
                            </div>
                        </div>
                        
                        <div id="mobile-tab2-content" style="display: none;">
                            <h3 style="color: #2c3e50; margin-bottom: 20px; text-align: center; font-size: 20px;">üîÑ Cycles de Vie</h3>
                            <div id="mobile-cycles-content"></div>
                        </div>
                        
                        <div id="mobile-tab3-content" style="display: none;">
                            <h3 style="color: #2c3e50; margin-bottom: 20px; text-align: center; font-size: 20px;">üéØ Phase de R√©alisation</h3>
                            <div id="mobile-realization-content"></div>
                        </div>
                    `;
                    
                    // Add inclusion grid if available
                    if (results.output2 && Array.isArray(results.output2)) {
                        const gridContainer = document.getElementById('mobile-inclusion-grid');
                        if (gridContainer) {
                            let gridHTML = '<table style="width: 100%; border-collapse: collapse; font-size: 16px;">';
                            gridHTML += '<tr style="background: #3498db; color: white;"><th style="padding: 10px; border: 1px solid #ddd;">Nombre</th><th style="padding: 10px; border: 1px solid #ddd;">Occurrences</th></tr>';
                            
                            results.output2.forEach(item => {
                                gridHTML += `<tr><td style="padding: 10px; border: 1px solid #ddd; text-align: center; font-weight: bold;">${item.number}</td><td style="padding: 10px; border: 1px solid #ddd; text-align: center;">${item.display}</td></tr>`;
                            });
                            
                            gridHTML += '</table>';
                            gridContainer.innerHTML = gridHTML;
                        }
                    }
                    
                    // Add cycles if available
                    if (results.cycles) {
                        const cyclesContainer = document.getElementById('mobile-cycles-content');
                        if (cyclesContainer) {
                            let cyclesHTML = '';
                            Object.values(results.cycles).forEach(cycle => {
                                cyclesHTML += `
                                    <div style="background: #f8f9fa; border: 2px solid #e9ecef; border-radius: 12px; padding: 20px; margin-bottom: 15px;">
                                        <h4 style="color: #2c3e50; margin-bottom: 10px;">${cycle.label}</h4>
                                        <p style="color: #6c757d; margin-bottom: 10px;">${cycle.ageRange}</p>
                                        <div style="font-size: 32px; font-weight: bold; color: #27ae60; text-align: center;">${cycle.value}</div>
                                    </div>
                                `;
                            });
                            cyclesContainer.innerHTML = cyclesHTML;
                        }
                    }
                    
                    // Add realization if available
                    if (results.realization) {
                        const realizationContainer = document.getElementById('mobile-realization-content');
                        if (realizationContainer) {
                            let realizationHTML = '';
                            Object.values(results.realization).forEach(item => {
                                realizationHTML += `
                                    <div style="background: #f8f9fa; border: 2px solid #e9ecef; border-radius: 12px; padding: 20px; margin-bottom: 15px;">
                                        <h4 style="color: #2c3e50; margin-bottom: 10px;">${item.label}</h4>
                                        <p style="color: #6c757d; margin-bottom: 10px;">${item.description}</p>
                                        <div style="font-size: 32px; font-weight: bold; color: #27ae60; text-align: center;">${item.value}</div>
                                    </div>
                                `;
                            });
                            realizationContainer.innerHTML = realizationHTML;
                        }
                    }
                };
                
                // STEP 8: Create tab switching function
                window.showMobileTabContent = function(activeTabId) {
                    const contents = ['mobile-tab1-content', 'mobile-tab2-content', 'mobile-tab3-content'];
                    contents.forEach(contentId => {
                        const content = document.getElementById(contentId);
                        if (content) {
                            content.style.display = contentId === activeTabId.replace('mobile-tab', 'mobile-tab') + '-content' ? 'block' : 'none';
                        }
                    });
                };
            }
        }
        
        // Run mobile interface replacement
        createMobileOnlyInterface();
        document.addEventListener('DOMContentLoaded', createMobileOnlyInterface);
        window.addEventListener('load', createMobileOnlyInterface);
            const isMobile = window.innerWidth <= 480 || /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);
            
            if (isMobile) {
                console.log('üö® FINAL NUCLEAR: Creating complete mobile-only interface');
                
                // STEP 1: Hide the entire right panel
                const rightPanel = document.querySelector('.right-panel');
                if (rightPanel) {
                    rightPanel.style.display = 'none !important';
                }
                
                // STEP 2: Create a brand new mobile results container
                let mobileResults = document.getElementById('mobile-results-interface');
                if (mobileResults) {
                    mobileResults.remove();
                }
                
                mobileResults = document.createElement('div');
                mobileResults.id = 'mobile-results-interface';
                mobileResults.style.cssText = `
                    position: fixed !important;
                    top: 50vh !important;
                    left: 0 !important;
                    right: 0 !important;
                    bottom: 120px !important;
                    background: white !important;
                    border: 3px solid #3498db !important;
                    border-radius: 12px 12px 0 0 !important;
                    z-index: 1000000 !important;
                    overflow-y: auto !important;
                    -webkit-overflow-scrolling: touch !important;
                    padding: 20px !important;
                    box-shadow: 0 -10px 30px rgba(0,0,0,0.3) !important;
                `;
                
                // STEP 3: Create mobile tab navigation
                const mobileTabNav = document.createElement('div');
                mobileTabNav.style.cssText = `
                    display: flex !important;
                    margin-bottom: 20px !important;
                    border-bottom: 2px solid #ecf0f1 !important;
                    padding-bottom: 10px !important;
                `;
                
                const tabs = [
                    { id: 'mobile-tab1', label: 'Piliers', active: true },
                    { id: 'mobile-tab2', label: 'Cycles', active: false },
                    { id: 'mobile-tab3', label: 'R√©alisation', active: false }
                ];
                
                tabs.forEach(tab => {
                    const tabBtn = document.createElement('button');
                    tabBtn.id = tab.id;
                    tabBtn.textContent = tab.label;
                    tabBtn.style.cssText = `
                        flex: 1 !important;
                        padding: 15px 10px !important;
                        border: none !important;
                        background: ${tab.active ? '#3498db' : '#f8f9fa'} !important;
                        color: ${tab.active ? 'white' : '#7f8c8d'} !important;
                        font-size: 16px !important;
                        font-weight: 700 !important;
                        border-radius: 8px !important;
                        margin: 0 3px !important;
                        cursor: pointer !important;
                        -webkit-tap-highlight-color: transparent !important;
                    `;
                    
                    tabBtn.addEventListener('click', function() {
                        // Update tab states
                        mobileTabNav.querySelectorAll('button').forEach(btn => {
                            btn.style.background = '#f8f9fa !important';
                            btn.style.color = '#7f8c8d !important';
                        });
                        this.style.background = '#3498db !important';
                        this.style.color = 'white !important';
                        
                        // Show corresponding content
                        showMobileTabContent(tab.id);
                    });
                    
                    mobileTabNav.appendChild(tabBtn);
                });
                
                // STEP 4: Create mobile content area
                const mobileContent = document.createElement('div');
                mobileContent.id = 'mobile-content-area';
                mobileContent.style.cssText = `
                    min-height: 300px !important;
                    background: white !important;
                    padding: 10px !important;
                `;
                
                // STEP 5: Add initial empty state
                mobileContent.innerHTML = `
                    <div id="mobile-empty-state" style="
                        text-align: center !important;
                        color: #7f8c8d !important;
                        font-size: 18px !important;
                        padding: 40px 20px !important;
                        background: #f8f9fa !important;
                        border-radius: 12px !important;
                        border: 2px dashed #bdc3c7 !important;
                        line-height: 1.5 !important;
                    ">
                        Remplissez le formulaire et appuyez sur CALCULER pour voir vos r√©sultats ici.
                    </div>
                `;
                
                // STEP 6: Assemble mobile interface
                mobileResults.appendChild(mobileTabNav);
                mobileResults.appendChild(mobileContent);
                document.body.appendChild(mobileResults);
                
                console.log('‚úÖ FINAL NUCLEAR: Mobile-only interface created');
                
                // STEP 7: Create mobile results display function
                window.displayMobileResults = function(results) {
                    console.log('üì± Displaying results in mobile interface:', results);
                    
                    const contentArea = document.getElementById('mobile-content-area');
                    if (!contentArea) return;
                    
                    // Hide empty state
                    const emptyState = document.getElementById('mobile-empty-state');
                    if (emptyState) {
                        emptyState.style.display = 'none';
                    }
                    
                    // Create results HTML
                    contentArea.innerHTML = `
                        <div id="mobile-tab1-content" style="display: block;">
                            <h3 style="color: #2c3e50; margin-bottom: 20px; text-align: center; font-size: 20px;">üìä Piliers de Num√©rologie</h3>
                            
                            <div style="background: #e8f5e8; border: 2px solid #27ae60; border-radius: 12px; padding: 20px; margin-bottom: 20px; text-align: center;">
                                <h4 style="color: #2c3e50; margin-bottom: 10px;">Chemin de vie</h4>
                                <div style="font-size: 36px; font-weight: bold; color: #27ae60;">${results.output1 || 'N/A'}</div>
                            </div>
                            
                            <div style="background: #e8f4fd; border: 2px solid #3498db; border-radius: 12px; padding: 20px; margin-bottom: 20px; text-align: center;">
                                <h4 style="color: #2c3e50; margin-bottom: 10px;">Nombre d'expression</h4>
                                <div style="font-size: 36px; font-weight: bold; color: #3498db;">${results.output3 || 'N/A'}</div>
                            </div>
                            
                            <div style="background: #fff3cd; border: 2px solid #ffc107; border-radius: 12px; padding: 20px;">
                                <h4 style="color: #2c3e50; margin-bottom: 15px; text-align: center;">Grille d'inclusion</h4>
                                <div id="mobile-inclusion-grid"></div>
                            </div>
                        </div>
                        
                        <div id="mobile-tab2-content" style="display: none;">
                            <h3 style="color: #2c3e50; margin-bottom: 20px; text-align: center; font-size: 20px;">üîÑ Cycles de Vie</h3>
                            <div id="mobile-cycles-content"></div>
                        </div>
                        
                        <div id="mobile-tab3-content" style="display: none;">
                            <h3 style="color: #2c3e50; margin-bottom: 20px; text-align: center; font-size: 20px;">üéØ Phase de R√©alisation</h3>
                            <div id="mobile-realization-content"></div>
                        </div>
                    `;
                    
                    // Add inclusion grid if available
                    if (results.output2 && Array.isArray(results.output2)) {
                        const gridContainer = document.getElementById('mobile-inclusion-grid');
                        if (gridContainer) {
                            let gridHTML = '<table style="width: 100%; border-collapse: collapse; font-size: 16px;">';
                            gridHTML += '<tr style="background: #3498db; color: white;"><th style="padding: 10px; border: 1px solid #ddd;">Nombre</th><th style="padding: 10px; border: 1px solid #ddd;">Occurrences</th></tr>';
                            
                            results.output2.forEach(item => {
                                gridHTML += `<tr><td style="padding: 10px; border: 1px solid #ddd; text-align: center; font-weight: bold;">${item.number}</td><td style="padding: 10px; border: 1px solid #ddd; text-align: center;">${item.display}</td></tr>`;
                            });
                            
                            gridHTML += '</table>';
                            gridContainer.innerHTML = gridHTML;
                        }
                    }
                    
                    // Add cycles if available
                    if (results.cycles) {
                        const cyclesContainer = document.getElementById('mobile-cycles-content');
                        if (cyclesContainer) {
                            let cyclesHTML = '';
                            Object.values(results.cycles).forEach(cycle => {
                                cyclesHTML += `
                                    <div style="background: #f8f9fa; border: 2px solid #e9ecef; border-radius: 12px; padding: 20px; margin-bottom: 15px;">
                                        <h4 style="color: #2c3e50; margin-bottom: 10px;">${cycle.label}</h4>
                                        <p style="color: #6c757d; margin-bottom: 10px;">${cycle.ageRange}</p>
                                        <div style="font-size: 32px; font-weight: bold; color: #27ae60; text-align: center;">${cycle.value}</div>
                                    </div>
                                `;
                            });
                            cyclesContainer.innerHTML = cyclesHTML;
                        }
                    }
                    
                    // Add realization if available
                    if (results.realization) {
                        const realizationContainer = document.getElementById('mobile-realization-content');
                        if (realizationContainer) {
                            let realizationHTML = '';
                            Object.values(results.realization).forEach(item => {
                                realizationHTML += `
                                    <div style="background: #f8f9fa; border: 2px solid #e9ecef; border-radius: 12px; padding: 20px; margin-bottom: 15px;">
                                        <h4 style="color: #2c3e50; margin-bottom: 10px;">${item.label}</h4>
                                        <p style="color: #6c757d; margin-bottom: 10px;">${item.description}</p>
                                        <div style="font-size: 32px; font-weight: bold; color: #27ae60; text-align: center;">${item.value}</div>
                                    </div>
                                `;
                            });
                            realizationContainer.innerHTML = realizationHTML;
                        }
                    }
                };
                
                // STEP 8: Create tab switching function
                window.showMobileTabContent = function(activeTabId) {
                    const contents = ['mobile-tab1-content', 'mobile-tab2-content', 'mobile-tab3-content'];
                    contents.forEach(contentId => {
                        const content = document.getElementById(contentId);
                        if (content) {
                            content.style.display = contentId === activeTabId.replace('mobile-tab', 'mobile-tab') + '-content' ? 'block' : 'none';
                        }
                    });
                };
            }
        }
        
        // NUCLEAR OUTPUT VISIBILITY FIX
        function forceOutputVisibility() {
            const isMobile = window.innerWidth <= 480 || /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);
            
            if (isMobile) {
                console.log('üö® NUCLEAR: Forcing output visibility on iPhone');
                
                // Force show all result containers when they have content
                const resultContainers = document.querySelectorAll('#results-container, #cycles-container, #realization-container');
                resultContainers.forEach(container => {
                    if (container && container.children.length > 0) {
                        container.style.cssText = `
                            display: block !important;
                            visibility: visible !important;
                            opacity: 1 !important;
                            position: relative !important;
                            z-index: 1000 !important;
                            background: white !important;
                            padding: 15px !important;
                            margin: 10px 0 !important;
                            border: 2px solid #3498db !important;
                            border-radius: 8px !important;
                            min-height: 200px !important;
                            overflow: visible !important;
                        `;
                    }
                });
                
                // Force show all result items
                const resultItems = document.querySelectorAll('.result-item, .cycle-item, .realization-item');
                resultItems.forEach(item => {
                    item.style.cssText = `
                        display: block !important;
                        visibility: visible !important;
                        opacity: 1 !important;
                        background: #f8f9fa !important;
                        border: 2px solid #e9ecef !important;
                        border-radius: 8px !important;
                        padding: 20px !important;
                        margin: 10px 0 !important;
                        text-align: center !important;
                        min-height: 80px !important;
                        font-size: 16px !important;
                        line-height: 1.4 !important;
                        color: #2c3e50 !important;
                        position: relative !important;
                        z-index: 1001 !important;
                    `;
                });
                
                // Force show result values
                const resultValues = document.querySelectorAll('.result-value, .cycle-value, .realization-value');
                resultValues.forEach(value => {
                    value.style.cssText = `
                        display: block !important;
                        visibility: visible !important;
                        opacity: 1 !important;
                        font-size: 24px !important;
                        font-weight: bold !important;
                        color: #27ae60 !important;
                        margin: 10px 0 !important;
                        text-align: center !important;
                        line-height: 1.2 !important;
                    `;
                });
                
                // Force show result titles
                const resultTitles = document.querySelectorAll('.result-item h3, .cycle-item h3, .realization-item h3');
                resultTitles.forEach(title => {
                    title.style.cssText = `
                        display: block !important;
                        visibility: visible !important;
                        opacity: 1 !important;
                        color: #2c3e50 !important;
                        font-size: 16px !important;
                        font-weight: bold !important;
                        margin-bottom: 10px !important;
                        text-align: center !important;
                    `;
                });
                
                // Force show occurrence tables
                const occurrenceTables = document.querySelectorAll('.occurrence-table');
                occurrenceTables.forEach(table => {
                    table.style.cssText = `
                        display: table !important;
                        visibility: visible !important;
                        opacity: 1 !important;
                        width: 100% !important;
                        margin: 10px auto !important;
                        border-collapse: collapse !important;
                        font-size: 14px !important;
                        background: white !important;
                    `;
                });
                
                // Force show table cells
                const tableCells = document.querySelectorAll('.occurrence-table th, .occurrence-table td');
                tableCells.forEach(cell => {
                    cell.style.cssText = `
                        display: table-cell !important;
                        visibility: visible !important;
                        opacity: 1 !important;
                        border: 1px solid #ddd !important;
                        padding: 8px !important;
                        text-align: center !important;
                        font-size: 14px !important;
                        line-height: 1.2 !important;
                    `;
                });
                
                // Hide empty states when results are present
                const emptyStates = document.querySelectorAll('.empty-state');
                emptyStates.forEach(state => {
                    const parentArea = state.closest('.results-area, .cycles-area, .realization-area');
                    if (parentArea) {
                        const resultContainer = parentArea.querySelector('[id$="-container"]');
                        if (resultContainer && resultContainer.children.length > 0) {
                            state.style.display = 'none !important';
                        }
                    }
                });
                
                console.log('‚úÖ NUCLEAR: Output visibility forced');
            }
        }
        
        // Run output visibility fix
        forceOutputVisibility();
        document.addEventListener('DOMContentLoaded', forceOutputVisibility);
        window.addEventListener('load', forceOutputVisibility);
        
        // Also run after any DOM changes (when results are added)
        const observer = new MutationObserver(function(mutations) {
            mutations.forEach(function(mutation) {
                if (mutation.type === 'childList' && mutation.addedNodes.length > 0) {
                    setTimeout(forceOutputVisibility, 100);
                }
            });
        });
        
        // Start observing
        document.addEventListener('DOMContentLoaded', function() {
            observer.observe(document.body, {
                childList: true,
                subtree: true
            });
        });
    </script>
    
    <!-- Application JavaScript Modules -->
    <script src="js/version-manager.js"></script>
    <script src="js/calculator.js"></script>
    <script src="js/validator.js"></script>
    <script src="js/results-display.js"></script>
    <script src="js/form-handler.js"></script>
    <script src="js/test-suite.js"></script>
    <script src="js/app.js"></script>
    
    <!-- Mobile Frame Switcher for iPhone Optimization -->
    <script src="js/mobile-frame-switcher.js"></script>
    
    <!-- Mobile Interface System Components -->
    <script src="js/device-detection-manager.js"></script>
    <script src="js/state-sync-manager.js"></script>
    <script src="js/interface-switcher.js"></script>
    <script src="js/mobile-frame-controller.js"></script>
    <script src="js/mobile-form-compactor.js"></script>
    <script src="js/mobile-interface-init.js"></script>
</body>
</html>
